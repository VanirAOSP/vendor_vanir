#!/bin/bash

# Configuration
SOURCE_DIR=$"$(pwd)"
VANIR=$"m/n71"
SUB_BRANCH=$"remotes/vanir/n71-substratum"
REMOTE_BRANCH=$"n-mr1-oms7"


echo "YOU NEED TO RUN THIS FROM YOUR BUILD DIRECTORY"
sleep 3
echo ""
echo ""

# 3 have conflicts and need a resolution.  And FWN cleanly merged taint.
echo "Contacts"
cd $SOURCE_DIR/packages/apps/Contacts
git merge $SUB_BRANCH

echo "FWB"
cd $SOURCE_DIR/frameworks/base
git merge $SUB_BRANCH

echo "FW Native"
cd $SOURCE_DIR/frameworks/native
git merge $SUB_BRANCH

echo "Sepolicy"
cd $SOURCE_DIR/system/sepolicy
git merge $SUB_BRANCH

# Now the clean merges
echo ""
echo "Fetch-Sex-Magic"
# Masochism loops
substratum() {
cat<<EOF
Dialer
ExactCalculator
PhoneCommon
Settings
EOF
}

# Let's merge it
substratum | while read u
do
cd $SOURCE_DIR/packages/apps/${u}
git fetch https://github.com/SubstratumResources/platform_packages_apps_${u} $REMOTE_BRANCH
git merge FETCH_HEAD
done


# And the fucking annoying one that uses a different naming scheme
cd $SOURCE_DIR/packages/apps/ContactsCommon
git fetch https://github.com/SubstratumResources/packages_apps_ContactsCommon $REMOTE_BRANCH
git merge FETCH_HEAD


echo ""
echo ""
echo ""
echo "Member, need to merge commits to expose overlay for other AOSP apps and services... Member?"
